<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PhotoCloset</title>

    <script type="text/javascript" src="assets/js/jquery-3.2.0.min.js"></script>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>

    <script type="text/javascript" src="assets/js/angular.js"></script>

    <script type="text/javascript" src="app.js"></script>

    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet" href="assets/css/bootstrap.css">
    <link rel="stylesheet" href="assets/css/bootstrap-theme.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">

    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body ng-app="photocloset">
    <div class="container">
        <div class="col-md-8 col-md-offset-2">
            <div class="logoContainer">
                <img class="img-responsive" src="assets/images/closet.png">
                <h1>Photo Closet</h1>
            </div>
            <div ng-controller="formController">
                <div class="uploadFormContainer" ng-show="!uploading && !completed">
                    <div class="imageContainer">
                        <div class="col-md-12">
                            <input type="image" id="imagePreview" class="img-responsive" src="assets/images/placeholder.png">
                            <input type="file" id="my_file" file-uploader-model="file" style="display: none;" onchange="previewFile()"/>
                        </div>
                    </div>
                    <button class="btn" ng-click="uploadFile()">Upload</button>
                </div>
                <div class="uploadingAnimationContainer" ng-if="uploading && !completed">
                    <span class="fa fa-spinner fa-3x"></span>
                    <h1>Uploading</h1>
                </div>
                <div class="uploadResponseContainer" ng-if="!uploading && completed">
                    <h1 ng-class="{'text-red': !success}">{{message}}</h1>
                    <h3 ng-if="!success">{{error}}</h3>
                    <h3 ng-if="success">Link: <a ng-href="{{fileUrl}}" target="_blank">{{fileUrl}}</a></h3>
                    <button class="btn" ng-click="goBack()">Go back</button>
                </div>
            </div>
        </div>
    </div>


    <script>
        $("#imagePreview").click(function() {
            $("#my_file").click();
        });

        function previewFile() {
                console.log("preview file called");
                var preview = document.getElementById('imagePreview');
                var file    = document.querySelector('input[type=file]').files[0];
                var reader  = new FileReader();

                reader.onloadend = function () {
                    preview.src = reader.result;
                }

                if (file) {
                    reader.readAsDataURL(file);
                } else {
                    preview.src = "assets/images/placeholder.png";
                }

        }
    </script>
</body>
</html>